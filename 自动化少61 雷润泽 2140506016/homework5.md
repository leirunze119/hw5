# 数字图像与视频处理

## 第五次作业报告

----

姓名：雷润泽

班级：自动化少61

学号：2140506016

----

**摘要：** 本次作业完成的主要内容为设计频域低通滤波器，包括高斯低通滤波器、巴特沃斯低通滤波器等，以及频域高通滤波器，包括高斯高通滤波器、巴特沃斯高通滤波器、拉普拉斯滤波器和钝化模板等，并应用这些频域滤波器对图像进行滤波处理。

### 1.频域低通滤波器

**思路分析：** 在之前的作业中，我们使用了空域低通和高通滤波器对图像进行了处理。频域的低通和高通滤波器与空域滤波器从本质上来说并无差异，对于一个空域滤波器，只要对其进行适当的补0并做离散傅里叶变换即可得到其相应的频域滤波器，但在计算方法上，二者存在一定的差异。空域滤波器是在空域对图像和模板做卷积处理，而频域滤波器则是将图像的离散傅里叶变换与频域滤波函数做乘积处理，空域卷积与频域乘积是具有对应关系的。

图像的频域滤波处理的一般步骤为：

1.对图像f(x,y)进行弧度为π的空域相移，即乘以-1的x+y次方，目的是对其频域进行平移，使其低频点位于图像中央，而高频点位于图像边缘；

2.对相移后的图像进行DFT，其中DFT在两个方向上的长度为原图像对应两个方向像素点数的两倍，没有数据的部分进行补0处理，得到图像频谱F(u,v)；

3.将滤波函数H(u,v)与图像频谱F(u,v)在频域相乘，得到处理后的图像频谱G(u,v)=H(u,v)F(u,v)，这相当于对二者在空域进行卷积；

4.对G(u,v)作IDFT，取其实部并去除DFT中添加的0点，并对图像再次做弧度为π的空域相移，得到处理后的图像g(x,y)。

图像的频域处理都可以采用以上的方式进行，在本次作业中，滤波函数H(u,v)取的是低通或高通滤波器。

图像低通滤波器主要用于实现图像的平滑和降噪处理。频域高斯低通滤波器由下式给出

![](http://latex.codecogs.com/gif.latex?H(u,v)=e^{-D^2(u,v)/2D_0^2})

频域巴特沃斯低通滤波器则为

![](http://latex.codecogs.com/gif.latex?H(u,v)=\frac{1}{1+[D(u,v)/D_0]^{2n}})

其中，D(u,v)为频域中的点(u,v)到频率矩形中心的距离，D0为低通滤波器的截止频率，n为巴特沃斯低通滤波器的阶次。

使用matlab编写函数`gaussianf`以生成频域高斯滤波器(函数代码参见`/codes/gaussianf.txt`)，编写函数`butterworthf`以生成频域巴特沃斯滤波器(函数代码参见`/codes/butterworthf.txt`)，并编写函数`ff`实现对图像的频域处理过程，(函数代码参见`/codes/ff.txt`)分别调用这些函数即可实现对图像频域低通滤波处理。

**代码实现：** 参见`/codes/h5_1.txt`

**处理结果：**

test1.pgm的处理结果，其中使用的高斯低通滤波器的截止频率为25，使用的巴特沃斯低通滤波器的截止频率为25，阶次为3。

![test1.pgm的处理结果](paperpics/h5_1_test1.bmp "h5_1_test1.bmp")

test2.tif的处理结果，其中使用的高斯低通滤波器的截止频率为25，使用的巴特沃斯低通滤波器的截止频率为25，阶次为3。

![test2.tif的处理结果](paperpics/h5_1_test2.bmp "h5_1_test2.bmp")

注意以上两图中，为了清晰显示处理前后图像的频谱，已对频谱的模值进行了归一化和放大处理。

比较处理结果与原始图像可知，高斯低通滤波器和巴特沃斯低通滤波器都都可以实现对图像的低通滤波处理，实现对图像的平滑和降噪。对比两种滤波器的处理结果，从空域上看处理结果，巴特沃斯低通滤波器的平滑效果比高斯滤波器更强，从处理后的图像频谱和功率谱比中则可以看出，二者的区别在于巴特沃斯低通滤波器的过渡带宽较小，最大通带衰减较小，最小阻带衰减较大，因此在截止频率相同的条件下，其低通效果比高斯低通滤波器更明显，因此对图像的平滑效果更强。

### 2.频域高斯、巴特沃斯高通滤波器

**思路分析：** 图像高通滤波器主要用于实现图像的增强和边缘提取等处理。频域高斯高通滤波器由下式给出

![](http://latex.codecogs.com/gif.latex?H(u,v)=1-e^{-D^2(u,v)/2D_0^2})

频域巴特沃斯高通滤波器则为

![](http://latex.codecogs.com/gif.latex?H(u,v)=\frac{1}{1+[D_0/D(u,v)]^{2n}})

其中，D(u,v)为频域中的点(u,v)到频率矩形中心的距离，D0为高通滤波器的截止频率，n为巴特沃斯高通滤波器的阶次。

使用matlab编写函数`gaussianf`以生成频域高斯滤波器(函数代码参见`/codes/gaussianf.txt`)，编写函数`butterworthf`以生成频域巴特沃斯滤波器(函数代码参见`/codes/butterworthf.txt`)，并编写函数`ff`实现对图像的频域处理过程，(函数代码参见`/codes/ff.txt`)分别调用这些函数即可实现对图像频域高通滤波处理。

**代码实现：** 参见`/codes/h5_2.txt`

**处理结果：**

test3_corrupt.pgm的处理结果，其中使用的高斯低高滤波器的截止频率为20，使用的巴特沃斯高通滤波器的截止频率为20，阶次为3。

![test3_corrupt.pgm的处理结果](paperpics/h5_2_test3.bmp "h5_2_test3.bmp")

test4 copy.bmp的处理结果，其中使用的高斯低高滤波器的截止频率为20，使用的巴特沃斯高通滤波器的截止频率为20，阶次为3。

![test4 copy.bmp的处理结果](paperpics/h5_2_test4.bmp "h5_2_test4.bmp")

注意以上两图中，为了清晰显示处理前后图像的频谱，已对频谱的模值进行了归一化和放大处理。

比较处理结果与原始图像可知，高斯高通滤波器和巴特沃斯高通滤波器都都可以实现对图像的高通滤波处理，实现对图像的边缘提取。对比两种滤波器的处理结果，其差异在空域上看不太明显，但在频域上，可以从处理后的图像频谱和功率谱比中看出两种滤波器处理后的结果存在较为明显的区别，巴特沃斯高通滤波器的过渡带宽较小，最大通带衰减较小，最小阻带衰减较大，因此在截止频率相同的条件下，巴特沃斯低通滤波器处理后的低频成分更少。

### 3.频域拉普拉斯、钝化模板高通滤波器

**思路分析：** 频域拉普拉斯高通滤波器由下式给出

![](http://latex.codecogs.com/gif.latex?H(u,v)=-4\pi^2(u^2+v^2))

频域钝化模板的基本原理则是先对图像进行低通滤波处理，由于低通滤波器对图像的边缘处作用效果明显，故原图像与低通滤波后的图像的差即可以反映原图的边缘分布状况，再将差值乘以一个系数并叠加在原图像上，即可实现对图像的边缘增强处理。由于在频率域有

![](http://latex.codecogs.com/gif.latex?1-H_{LP}(u,v)=H_{HP}(u,v))

即（1-低通滤波函数）=高通滤波函数，因此钝化模板处理一般可表示为

![](http://latex.codecogs.com/gif.latex?H(u,v)=1+kH_{HP}(u,v))

其中k为高提升滤波系数。

使用matlab编写函数`laplacef`以生成频域拉普拉斯滤波器(函数代码参见`/codes/laplacef.txt`)，钝化模板处理中的高通滤波器则直接使用了巴特沃斯高通滤波器，并编写函数`ff`实现对图像的频域处理过程，(函数代码参见`/codes/ff.txt`)分别调用这些函数即可实现对图像频域高通滤波处理。

**代码实现：** 参见`/codes/h5_3.txt`

**处理结果：**

test3_corrupt.pgm的处理结果，其中，在钝化模板中处理中使用的巴特沃斯高通滤波器的截止频率为25，阶次为3，高提升滤波系数为2.5。

![test3_corrupt.pgm的处理结果](paperpics/h5_3_test3.bmp "h5_3_test3.bmp")

test4 copy.bmp的处理结果，其中，在钝化模板中处理中使用的巴特沃斯高通滤波器的截止频率为25，阶次为3，高提升滤波系数为2.5。注意在对test4的处理中，由于laplace滤波器的处理结果灰度范围过小，显示结果不清晰，故在此图中以对其处理后的灰度作了20倍的放大处理。

![test4 copy.bmp的处理结果](paperpics/h5_3_test4.bmp "h5_3_test4.bmp")

注意以上两图中，为了清晰显示处理前后图像的频谱，已对频谱的模值进行了归一化和放大处理。

将频域拉普拉斯高通滤波器与上题中的高斯高通滤波器和巴特沃斯高通滤波器作对比，一方面拉普拉斯滤波器对于高频信息具有的放大能力，因此相比于高斯高通滤波器和巴特沃斯高通滤波器，拉普拉斯滤波器能够更好地提取图像的高频信息，但另一方面拉普拉斯滤波器也对图像噪声更加敏感，此外，拉普拉斯滤波器在除频域的零频点之外的频率上，对于低频信息的衰减作用较小，导致处理后的图像对比度较低，需要通过进一步的处理才能够观看。

在钝化模板处理中，选取了大于1的k值实现高提升滤波的效果，可见其处理结果相当于将图像的边缘高频信息提取并放大后叠加在原始图像上，可以实现对图像边缘的增强效果。

## 附录

### 程序代码

参见目录`/codes`下的文件，其中文件`h5_*.txt`为作业对应题目的matlab脚本代码，其他文件为使用到的自行编写的matlab函数文件。

### 处理结果

处理后的图像参见目录`/images`下的文件，其中文件名带有`gaussian_low`的文件为高斯低通滤波器的处理结果，文件名带有`gaussian_high`的文件为高斯高通滤波器的处理结果，文件名带有`butterworth_low`的文件为巴特沃斯低通滤波器的处理结果，文件名带有`butterworth_high`的文件为巴特沃斯高通滤波器的处理结果，文件名带有`laplace`的文件为拉普拉斯滤波器的处理结果，文件名带有`unmask`的文件为钝化模板的处理结果。

报告中使用的图片参见目录`/paperpics`下的文件。
